<template>
  <div if.bind="connecting">
    connecting to draft id ${draftCode}...
  </div>

  <div if.bind="connectionFailed">
    Connection failed, check code or draft is still running
  </div>

  <div if.bind="!connectionFailed && !connecting && draftState">
    <h2>Draft '${draftState.setup.name}' on map ${draftState.setup.mapName}</h2>
    <h3>Viewing as ${getDraftStateName()}</h3>
    <div>Admin connected: ${snapshot.adminConnected ? 'TRUE' : 'FALSE'}</div>
    <div>red captain connected: ${snapshot.redConnected ? 'TRUE' : 'FALSE'}</div>
    <div>blue captain connected: ${snapshot.blueConnected ? 'TRUE' : 'FALSE'}</div>
    <div># results viewers ${snapshot.resultsViewers}</div>

    <div>Red ready ${snapshot.redReady ? 'YES' : 'NO' }</div>
    <div>Blue ready ${snapshot.blueReady ? 'YES' : 'NO' }</div>


    <div if.bind="isAdmin() && !snapshot.draftDone">
      <button if.bind="!snapshot.voteActive" click.trigger="startPhaseVote()">Start ${snapshot.currentVote.phaseType}
        voting
      </button>
    </div>

    <div if.bind="isCaptain() && !snapshot.draftDone">
      <button click.trigger="sendReady()">Toggle READY</button>
    </div>

    <div if.bind="snapshot.voteActive">
      VOTING ACTIVE!
      <h3>${snapshot.currentVote.phaseType == 'ban' ? 'BANNING' : 'PICKING'}</h3>
      <strong>${countdownVal} seconds left ..</strong>

      <div if.bind="isAdmin()">
        <div>Red vote locked in ${snapshot.currentVote.redHasVoted ? 'YES' : 'NO' }</div>
        <div>Blue vote locked in ${snapshot.currentVote.blueHasVoted ? 'YES' : 'NO' }</div>
      </div>

      <div if.bind="isCaptain()">
        <select value.bind="selectedVoteValue" disabled.bind="!lockinEnabled">
          <option model.bind="none">Choose ..</option>
          <optgroup label="melee">
            <option repeat.for="mc of validChampions.melee" model.bind="mc.name">${mc.displayName}</option>
          </optgroup>
          <optgroup label="ranged">
            <option repeat.for="rc of validChampions.ranged" model.bind="rc.name">${rc.displayName}</option>
          </optgroup>
          <optgroup label="support">
            <option repeat.for="sc of validChampions.support" model.bind="sc.name">${sc.displayName}</option>
          </optgroup>
        </select>
        <button click.trigger="lockinVote()" disabled.bind="!lockinEnabled">Lock in</button>
      </div>
    </div>

    <div>
      <div repeat.for="p of snapshot.phases">
        Phase ${p.phaseType} (# ${p.phaseNum + 1})
        Red voted: ${p.voteRedValue}
        Blue voted: ${p.voteRedValue}
      </div>
    </div>
  </div>
</template>
